{#
    Copyright Â© 2014 mparaiso <mparaiso@online.fr>. All Rights Reserved.
    views/snippet.twig
#}
{% extends 'layout.twig' %}
{% block content %}
    <h3>
        {{snippet.title}} 
        {% include 'include//favorite.twig'%}
    </h3> 
    <p class="text-muted">
        <small>
            {{snippet.created_at|date('Y-m-d')}} <a href="/category/{{snippet.category.id}}/{{snippet.category.title}}">{{snippet.category.title}}</a> , by <a href="/user/{{snippet.user.id}}">{{snippet.user.username}}</a> 
        </small>
    </p>
    <p>{{snippet.description}}</p>
    <pre>{{snippet.content}}
</pre>
{#
<pre>
    {{snippet|json(4)}}
</pre>
#}
{% endblock %}
{% block scripts %}
    {{parent()}}
    <script type="text/javascript">
        var category = "{{snippet.category.title}}".toLowerCase();
    </script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/highlight.js/8.0/highlight.min.js"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/showdown/0.3.1/showdown.js"></script>
    <script src="/bower_components/lodash/dist/lodash.min.js"></script>
    <link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/8.0/styles/monokai_sublime.css" />
    <script type="text/javascript">
        /**
         * either display the code snippet with mardown or a syntax highlighter
         */
        var converter,el,pre;
        if(category!=="markdown"){
            hljs.highlightBlock(document.querySelector('pre'));
        }else{
            converter = new Showdown.converter();
            el=document.createElement('p');
            el.class="markdown";
            pre = document.querySelector('pre');
            el.innerHTML =converter.makeHtml(_.escape(pre.innerText));
            pre.parentElement.appendChild(el);
            pre.style.display="none";
        }
    </script>
{% endblock %}
